<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Currículo de Corredores - thIAguinho Soluções</title>
    <link rel="stylesheet" href="css/styles.css">
</head>
<body>

    <div class="container">
        <div class="header">
            <button class="auth-btn hidden" id="btn-back-to-public">⬅️ Voltar à Lista</button>
            
            <div class="auth-controls">
                <div id="user-info" class="hidden">
                    <span id="user-email"></span>
                </div>
                <button class="auth-btn hidden" id="btn-logout">Logout</button>
            </div>
            
            <h1>Currículo de Corridas de Rua 🏃🏽‍♂️🏃🏽‍♀️</h1>
            <p id="header-subtitle">Carregando...</p>
        </div>
        
        <div id="admin-panel" class="hidden">
            <h2>⚙️ Painel de Admin</h2>
            
            <h3>Aprovações Pendentes</h3>
            <div id="pending-list">
                <div class="loader" style="color:#1f2027;">Carregando...</div>
            </div>
            
            <h3>Usuários Aprovados</h3>
            <div id="approved-list">
                 <div class="loader" style="color:#1f2027;">Carregando...</div>
            </div>
        </div>

        <div id="login-or-public-view">
            
            <div id="login-view">
                <h2 id="login-title">Acessar Meu Currículo</h2>
                <form id="login-form">
                    <input type="email" id="login-email" placeholder="E-mail" required>
                    <input type="password" id="login-password" placeholder="Senha (mín. 6 caracteres)" required>
                    
                    <div id="signup-fields" class="hidden">
                        <input type="text" id="signup-runner1-name" placeholder="Seu nome (Ex: Thiago)" required>
                        <input type="text" id="signup-runner2-name" placeholder="Nome Corredor 2 (Opcional, Ex: Thamis)">
                        <input type="text" id="signup-team-name" placeholder="Nome da Equipe (Ex: Le Runners)">
                    </div>
                   
                    <div class="login-buttons">
                         <button type="button" class="auth-btn btn-primary" id="btn-login-submit">Entrar</button>
                         <button type="button" class="auth-btn" id="btn-signup-submit">Cadastrar</button>
                    </div>
                   
                    <div id="login-error"></div>
                    <a id="login-toggle-link">Não tem conta? Cadastre-se</a>
                </form>
            </div>

            <div id="public-view" class="hidden">
                <h2>Currículos Públicos</h2>
                <div class="profile-list" id="public-profile-list">
                    <div class="loader">Carregando perfis públicos...</div>
                </div>
            </div>
        </div>
        
        <div id="pending-approval-view" class="hidden">
            <h2>⏳ Cadastro Recebido</h2>
            <p>Sua conta foi criada com sucesso e está aguardando a aprovação do administrador. Você será liberado em breve.</p>
        </div>
        
        <div id="rejected-view" class="hidden">
            <h2>❌ Acesso Recusado</h2>
            <p>O cadastro para o e-mail <b id="rejected-email"></b> não foi aprovado pelo administrador. Entre em contato para mais informações.</p>
        </div>

        <div id="user-content" class="hidden">
            <div class="dashboard-section">
                <h2 class="dashboard-header">Dashboard de Performance</h2>
                <h3 class="dashboard-subheader">Recordes Pessoais (PRs)</h3>
                <div class="stats-grid" id="pr-grid">
                    <div class="loader">Carregando PRs...</div>
                </div>
                <h3 class="dashboard-subheader" style="margin-top: 30px;">Estatísticas Gerais</h3>
                <div class="stats-grid" id="summary-grid">
                    <div class="loader">Calculando...</div>
                </div>
            </div>

            <div class="controls-section hidden" id="controls-section">
                <button class="btn-add" id="btn-add-new">➕ Adicionar Nova Corrida</button>
            </div>

            <div class="history-section">
                <div id="history-container">
                    <div class="loader">Carregando histórico do Firebase...</div>
                </div>
            </div>
        </div>

        <div class="footer">
            Potencialize seus treinos e resultados com soluções digitais. 
            <a href="https://thiaguinhosolucoesia-tech.github.io/thIAguinhoSolucoes/" target="_blank" rel="noopener noreferrer">
                Desenvolvido com 🤖 por <strong>thIAguinho Soluções</strong>
            </a>
        </div>
    </div>

    <dialog id="race-modal">
        <form id="race-form">
            <input type="hidden" id="race-id">
            <div class="modal-header">
                <h2 id="modal-title">Adicionar Nova Corrida</h2>
                <button type="button" class="btn-control" id="btn-close-modal" aria-label="Fechar">✖️</button>
            </div>

            <div class="modal-body">
                <div class="form-group full-width">
                    <label for="raceName">Nome da Corrida</label>
                    <input type="text" id="raceName" required>
                </div>
                <div class="form-group">
                    <label for="raceDate">Data</label>
                    <input type="date" id="raceDate" required>
                </div>
                <div class="form-group">
                    <label for="raceDistance">Distância Padrão (km)</label>
                    <input type="number" step="0.1" id="raceDistance" placeholder="Ex: 5 (Deixe em branco se for misto)">
                </div>

                <div class="runner-form-group runner1" id="runner1-form-group">
                    <h4 id="runner1-form-name">Corredor 1 🏃‍♂️</h4>
                    <div class="form-group">
                        <label for="runner1Status">Status</label>
                        <select id="runner1Status">
                            <option value="completed">Completou ✅</option>
                            <option value="planned">Planejada ⏳</option>
                            <option value="skipped">Não Correu ❌</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="runner1Time">Tempo (HH:MM:SS)</label>
                        <input type="text" id="runner1Time" placeholder="00:29:10">
                    </div>
                    <div class="form-group">
                        <label for="runner1Distance">Distância (se diferente da padrão)</label>
                        <input type="number" step="0.1" id="runner1Distance" placeholder="Ex: 10">
                    </div>
                </div>

                <div class="runner-form-group runner2" id="runner2-form-group">
                    <h4 id="runner2-form-name">Corredor 2 🏃‍♀️</h4>
                    <div class="form-group">
                        <label for="runner2Status">Status</label>
                        <select id="runner2Status">
                            <option value="completed">Completou ✅</option>
                            <option value="planned">Planejada ⏳</option>
                            <option value="skipped">Não Correu ❌</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="runner2Time">Tempo (HH:MM:SS)</label>
                        <input type="text" id="runner2Time" placeholder="00:40:36">
                    </div>
                    <div class="form-group">
                        <label for="runner2Distance">Distância (se diferente da padrão)</label>
                        <input type="number" step="0.1" id="runner2Distance" placeholder="Ex: 5">
                    </div>
                </div>

                <div class="form-group checkbox">
                    <input type="checkbox" id="raceJuntos">
                    <label for="raceJuntos">Correram Juntos? 👩🏻‍❤️‍👨🏻</label>
                </div>

                <div class="form-group full-width">
                    <label for="raceNotes">Notas</label>
                    <input type="text" id="raceNotes" placeholder="Ex: Corrida com ♿, meta de tempo...">
                </div>
            </div>

            <div class="modal-footer">
                <button type="button" class="btn" id="btn-delete" class="hidden">Excluir</button>
                <button type="button" class="btn btn-secondary" id="btn-cancel">Cancelar</button>
                <button type="submit" class="btn btn-primary" id="btn-save">Salvar</button>
            </div>
        </form>
    </dialog>

    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-database-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-auth-compat.js"></script>

    <script src="js/config.js"></script>
    <script src="js/app.js"></script>

</body>
</html>
